<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Preset Versioning Demo</title>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            margin: 0;
            padding: 20px;
            background: #0f0f12;
            color: #f1f1f4;
            line-height: 1.6;
        }
        .container {
            max-width: 1000px;
            margin: 0 auto;
        }
        .demo-section {
            background: #18181d;
            border: 1px solid #2a2a33;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
        }
        .demo-title {
            color: #49a9ff;
            margin-bottom: 15px;
            font-size: 1.2em;
        }
        .code-block {
            background: #0f0f12;
            border: 1px solid #2a2a33;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            overflow-x: auto;
        }
        .highlight {
            background: rgba(73, 169, 255, 0.1);
            padding: 2px 4px;
            border-radius: 4px;
        }
        .version-badge {
            background: #49a9ff;
            color: #0f0f12;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.8em;
            font-weight: bold;
        }
        .legacy-badge {
            background: #ff6b35;
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.8em;
            font-weight: bold;
        }
        .migrated-badge {
            background: #94ff49;
            color: #0f0f12;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.8em;
            font-weight: bold;
        }
        .comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }
        .before, .after {
            background: #1a1a1a;
            border: 1px solid #333;
            border-radius: 8px;
            padding: 15px;
        }
        .before-title {
            color: #ff6b35;
            font-weight: bold;
            margin-bottom: 10px;
        }
        .after-title {
            color: #94ff49;
            font-weight: bold;
            margin-bottom: 10px;
        }
        .feature-list {
            list-style: none;
            padding: 0;
        }
        .feature-list li {
            padding: 8px 0;
            border-bottom: 1px solid #333;
        }
        .feature-list li:before {
            content: "✓ ";
            color: #94ff49;
            font-weight: bold;
        }
        .warning {
            background: rgba(255, 107, 53, 0.1);
            border: 1px solid #ff6b35;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }
        .info {
            background: rgba(73, 169, 255, 0.1);
            border: 1px solid #49a9ff;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Preset Versioning System Demo</h1>
        
        <div class="demo-section">
            <h2 class="demo-title">What is Preset Versioning?</h2>
            <p>Preset versioning ensures that your saved presets remain compatible as the application evolves. It provides:</p>
            <ul class="feature-list">
                <li>Version tracking for all presets</li>
                <li>Automatic migration of legacy presets</li>
                <li>Backward compatibility</li>
                <li>Preset history tracking</li>
                <li>Clear error messages for incompatible presets</li>
            </ul>
        </div>

        <div class="demo-section">
            <h2 class="demo-title">Before vs After</h2>
            <div class="comparison">
                <div class="before">
                    <div class="before-title">Legacy Preset (No Versioning)</div>
                    <div class="code-block">
{
  "name": "My Preset",
  "createdAt": "2024-01-01T00:00:00.000Z",
  "controls": { ... },
  "automation": { ... },
  "midiMappings": { ... }
}
                    </div>
                    <div class="warning">
                        <strong>Issues:</strong>
                        <ul>
                            <li>No version information</li>
                            <li>No migration path</li>
                            <li>Compatibility issues</li>
                            <li>No metadata support</li>
                        </ul>
                    </div>
                </div>
                <div class="after">
                    <div class="after-title">Versioned Preset</div>
                    <div class="code-block">
{
  "name": "My Preset",
  <span class="highlight">"version": "1.0.0",</span>
  <span class="highlight">"schemaVersion": 1,</span>
  "createdAt": "2024-01-01T00:00:00.000Z",
  <span class="highlight">"description": "Optional description",</span>
  <span class="highlight">"tags": ["ambient", "drone"],</span>
  <span class="highlight">"author": "Your Name",</span>
  "controls": { ... },
  "automation": { ... },
  "midiMappings": { ... }
}
                    </div>
                    <div class="info">
                        <strong>Benefits:</strong>
                        <ul>
                            <li>Version tracking</li>
                            <li>Migration support</li>
                            <li>Rich metadata</li>
                            <li>Future-proof</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <div class="demo-section">
            <h2 class="demo-title">Automatic Migration</h2>
            <p>When you load an old preset, the system automatically migrates it:</p>
            
            <div class="code-block">
// Legacy preset gets migrated automatically
const legacyPreset = {
  "name": "Old Preset",
  "controls": { ... }
};

// After migration:
{
  "name": "Old Preset",
  "version": "1.0.0",           // ← Added
  "schemaVersion": 1,           // ← Added
  "migratedAt": "2024-01-01...", // ← Added
  "controls": { ... }
}
            </div>
            
            <div class="info">
                <strong>Migration Process:</strong>
                <ol>
                    <li>Detect legacy preset (no version field)</li>
                    <li>Add current version information</li>
                    <li>Ensure all required fields exist</li>
                    <li>Mark with migration timestamp</li>
                    <li>Load normally</li>
                </ol>
            </div>
        </div>

        <div class="demo-section">
            <h2 class="demo-title">Version Information</h2>
            <p>Each preset now includes comprehensive version information:</p>
            
            <div class="code-block">
// Version badges in the UI
<span class="version-badge">v1.0.0</span>     // Current version
<span class="legacy-badge">Legacy</span>      // Old preset
<span class="migrated-badge">Migrated</span>  // Auto-migrated
            </div>
        </div>

        <div class="demo-section">
            <h2 class="demo-title">Preset History</h2>
            <p>The system now tracks all preset operations:</p>
            
            <div class="code-block">
// History entries
{
  "id": "hist_1704067200000_abc123",
  "timestamp": "2024-01-01T12:00:00.000Z",
  "action": "save",
  "presetName": "My Preset",
  "version": "1.0.0",
  "schemaVersion": 1
}
            </div>
            
            <p>You can view the history in the new <strong>History</strong> button in the presets section.</p>
        </div>

        <div class="demo-section">
            <h2 class="demo-title">Enhanced Save Dialog</h2>
            <p>When saving presets, you can now add:</p>
            <ul>
                <li><strong>Description:</strong> Optional description of the preset</li>
                <li><strong>Tags:</strong> Comma-separated tags for organization</li>
            </ul>
            
            <div class="info">
                <strong>Example:</strong><br>
                Name: "Deep Ambient Drone"<br>
                Description: "A slow-building ambient piece with evolving textures"<br>
                Tags: "ambient, drone, slow, evolving"
            </div>
        </div>

        <div class="demo-section">
            <h2 class="demo-title">Error Handling</h2>
            <p>The system provides clear feedback for different scenarios:</p>
            
            <div class="code-block">
// Status messages
"Preset 'My Preset' saved (v1.0.0)"
"Preset 'Old Preset' loaded (v1.0.0) (migrated from legacy)"
"Preset is incompatible with current version"
"Preset load failed: Invalid preset data"
            </div>
        </div>

        <div class="demo-section">
            <h2 class="demo-title">Testing</h2>
            <p>You can test the versioning system using the test page:</p>
            <div class="code-block">
<a href="test-versioning.html">Open Versioning Test Page</a>
            </div>
        </div>

        <div class="demo-section">
            <h2 class="demo-title">Future-Proof</h2>
            <p>This versioning system is designed to handle future updates:</p>
            <ul>
                <li>New preset formats can be added</li>
                <li>Migration functions can be implemented</li>
                <li>Backward compatibility is maintained</li>
                <li>Version validation prevents errors</li>
            </ul>
        </div>
    </div>
</body>
</html>